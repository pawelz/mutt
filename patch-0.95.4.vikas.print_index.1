--- mutt-0.95.4/patchlist.c.orig	Mon Mar 22 18:11:49 1999
+++ mutt-0.95.4/patchlist.c	Tue Mar 23 13:19:30 1999
@@ -16,6 +16,8 @@
 
 
 
+  printf("Feature patch: print_index          0.95.4 by Vikas Agnihotri\n");
+
 
 
   /* DO NOT MODIFY AFTER THIS LINE */
diff -bu mutt-0.95.4.orig/OPS mutt-0.95.4/OPS
--- mutt-0.95.4.orig/OPS	Sat Dec 12 09:05:35 1998
+++ mutt-0.95.4/OPS	Tue Mar 23 13:43:00 1999
@@ -148,6 +148,7 @@
 OP_VERSION "show the Mutt version number and date"
 OP_VIEW_ATTACH "view attachment using mailcap entry if necessary"
 OP_VIEW_ATTACHMENTS "show MIME attachments"
+OP_MAIN_PRINT_INDEX "print message index"
 OP_MAIN_SHOW_LIMIT "show currently active limit pattern"
 OP_MAIN_COLLAPSE_THREAD "collapse/uncollapse current thread"
 OP_MAIN_COLLAPSE_ALL "collapse/uncollapse all threads"
diff -bu mutt-0.95.4.orig/commands.c mutt-0.95.4/commands.c
--- mutt-0.95.4.orig/commands.c	Tue Feb  9 21:53:38 1999
+++ mutt-0.95.4/commands.c	Tue Mar 23 13:43:08 1999
@@ -639,6 +639,54 @@
   mutt_copy_message (fp, ctx, h, M_CM_DECODE, CH_WEED | CH_DECODE | CH_REORDER);
 }
 
+void mutt_print_index (MUTTMENU *menu)
+{
+  int i;
+  pid_t thepid;
+  FILE *fp;
+  char buf[STRING];
+  static char AsciiChars[M_TREE_MAX] = " ,|-| >*&";
+
+  if (query_quadoption (OPT_PRINT,"Print message index?") != M_YES)
+    return;
+
+  endwin ();
+  if ((thepid = mutt_create_filter (PrintCmd, &fp, NULL, NULL)) == -1)
+    return;
+
+  menu_status_line (buf, sizeof (buf), menu, NONULL (Status));
+  fprintf(fp,"%s\n",buf);
+
+  for (i = 0; i<menu->max; i++)
+  {
+   char *s;
+   menu->make_entry(buf,sizeof(buf),menu,i);
+   s = buf;
+   while (*s)
+   {
+    if ((unsigned char) *s < M_TREE_MAX)
+    {
+      while (*s && (unsigned char) *s < M_TREE_MAX)
+      {
+	fputc (AsciiChars[*s], fp);
+	s++;
+      }
+    }
+    else
+    {
+      fputc(*s,fp);
+      s++;
+    }
+   }
+   fprintf(fp,"\n");
+  }
+
+  fclose (fp);
+  if (mutt_wait_filter (thepid) || option (OPTWAITKEY))
+    mutt_any_key_to_continue (NULL);
+  mutt_message ("Message index printed.");
+}
+
 void mutt_print_message (HEADER *h)
 {
   int i, count = 0;
diff -bu mutt-0.95.4.orig/curs_main.c mutt-0.95.4/curs_main.c
--- mutt-0.95.4.orig/curs_main.c	Wed Mar  3 20:36:41 1999
+++ mutt-0.95.4/curs_main.c	Tue Mar 23 13:43:01 1999
@@ -1572,6 +1572,12 @@
 	MAYBE_REDRAW (menu->redraw);
 	break;
 
+      case OP_MAIN_PRINT_INDEX:
+
+        CHECK_MSGCOUNT;
+	mutt_print_index(menu);
+	break;
+
       case OP_PRINT:
 
 	CHECK_MSGCOUNT;
diff -Nru mutt-1.1.11.orig/functions.h mutt-1.1.11/functions.h
--- mutt-1.1.11.orig/functions.h	Sun Apr  2 23:33:12 2000
+++ mutt-1.1.11/functions.h	Sun Apr  2 23:34:45 2000
@@ -130,6 +130,7 @@
   { "previous-new",		OP_MAIN_PREV_NEW,		"\033\t" },
   { "next-unread",		OP_MAIN_NEXT_UNREAD,		NULL },
   { "previous-unread",		OP_MAIN_PREV_UNREAD,		NULL },
+  { "print-index",		OP_MAIN_PRINT_INDEX,		"P"},
   { "parent-message",		OP_MAIN_PARENT_MESSAGE,		"P" },
 
 
diff -bu mutt-0.95.4.orig/mutt_menu.h mutt-0.95.4/mutt_menu.h
--- mutt-0.95.4.orig/mutt_menu.h	Thu Jan  7 10:14:43 1999
+++ mutt-0.95.4/mutt_menu.h	Tue Mar 23 13:43:02 1999
@@ -90,6 +90,7 @@
 void menu_current_bottom (MUTTMENU *);
 void menu_check_recenter (MUTTMENU *);
 void menu_status_line (char *, size_t, MUTTMENU *, const char *);
+void mutt_print_index (MUTTMENU *);
 
 MUTTMENU *mutt_new_menu (void);
 void mutt_menuDestroy (MUTTMENU **);
